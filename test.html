<!doctype html>
<script src="RegExp.make.js"></script>
<style>
  .pass { background: #efe }
  .fail { background: #fee }
  td { font-family: monospace; white-space: pre }
</style>
<body>
<script>(function () {
  var tests = [
    [['^', '$'], ['foo'], '/^(?:foo)$/'],
    [['(?i)^([', '', ']{', '})', ''], ['\\', /[a-z]/, 42, /$/],
     '/^([\\\\a-z]{42})(?:$)/i'],

    [['^(#+)([^#\\r\\n]*)\\', ''], [1], '/^(#+)([^#\\r\\n]*)\\1/'],
  ];

  function el(name, parent, opt_text) {
    var el = document.createElement(name);
    parent.appendChild(el);
    if (opt_text) {
      el.appendChild(document.createTextNode(opt_text));
    }
    return el;
  }

  function stringify(arr) {
    var s = '';
    s += '[';
    for (var i = 0, n = arr.length; i < n; ++i) {
      if (i) { s += ', '; }
      var x = arr[i];
      if (x && 'object' == typeof x) {
        s += x;
      } else {
        s += JSON.stringify(x);
      }
    }
    s += ']';
    return s;
  }
  
  var table = el('table', document.body);
  var tr = el('tr', el('thead', table));
  el('th', tr, 'string parts');
  el('th', tr, 'values');
  el('th', tr, 'expected');
  el('th', tr, 'output');
  var tbody = el('tbody', table);
  for (var i = 0, n = tests.length; i < n; ++i) {
    var test = tests[i];
    var parts = test[0];
    var values = test[1];
    var expected = test[2];
    tr = el('tr', tbody);
    el('td', tr, JSON.stringify(parts));
    el('td', tr, stringify(values));
    el('td', tr, expected);
    var partsObj = parts.slice();
    partsObj.raw = parts.slice();
    var args = [partsObj];
    for (var j = 0; j < values.length; ++j) { args.push(values[j]); }
    var got = RegExp.make.apply(RegExp, args).toString();
    el('td', tr, got);
    tr.className += ' ' + (got === expected ? 'pass' : 'fail');
  }
}());</script>
